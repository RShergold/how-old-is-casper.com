<!DOCTYPE html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>How old is Casper?</title>
  <style>
    html,
    body {
      background-color: #3b4652;
      color: white;
      font-family: sans-serif;
      font-size: 16px;
      height: 100%;
      margin: 0;
    }

    body {
      align-items: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    h1 {
      font-size: 3rem;
      margin: 2rem;
      text-align: center;
    }

    h2 {
      font-size: 1rem;
      opacity: 0.75;
      text-align: center;
    }

    ul {
      font-size: 1rem;
      line-height: 1.5rem;
      list-style: none;
      margin: 0;
      opacity: 0.75;
      padding: 0;
    }
  </style>
  <script>
    const SECOND = 1000;
    const MINUTE = SECOND * 60;
    const HOUR = MINUTE * 60;
    const DAY = HOUR * 24;
    const WEEK = DAY * 7;

    const birthday = new Date('2019-04-03T12:26:00');
    const now = new Date();

    const yearDiff = now.getFullYear() - birthday.getFullYear();
    const monthDiff = now.getMonth() - birthday.getMonth();
    const dayDiff = now.getDate() - birthday.getDate();

    // As fraction of month
    const dayDiffFraction = (1 / 30) * dayDiff;

    // As fraction of year
    const monthDiffFraction = (1 / 12) * (monthDiff + dayDiffFraction);

    const values = {
      hours: (now - birthday) / HOUR,
      days: (now - birthday) / DAY,
      weeks: (now - birthday) / WEEK,
      months: yearDiff * 12 + monthDiff + dayDiffFraction,
      years: yearDiff + monthDiffFraction
    };

    function getHeadline() {
      // Age in months
      if (values.months <= 19) {
        const absMonths = Math.floor(values.months);
        const isToday = Number.isInteger(values.months);
        const remainderMonths = values.months % 1;
        let fraction = '';
        if (remainderMonths >= 0.5 && remainderMonths < 0.75) {
          fraction = ' and a half';
        }
        if (remainderMonths >= 0.75) {
          fracrion = ' and 3 quarter';
        }
        return `${absMonths}${fraction} months old ${isToday ? 'today!' : ''}`
      }

      if (values.years < 2) {
        return 'nearly 2';
      }

      // Age in years
      const absYears = Math.floor(values.years);
      const isBirthday = Number.isInteger(values.years);
      const remainderYears = values.years % 1;
      let fraction = '';
      if (remainderYears >= 0.25 && remainderYears < 0.5) {
        fraction = ' and a quarter';
      }
      if (remainderYears >= 0.5 && remainderYears < 0.75) {
        fraction = ' and a half';
      }
      if (remainderYears >= 0.75) {
        fraction = ' and 3 quarter';
      }
      return `${absYears}${fraction} years old ${isBirthday ? 'today!' : ''}`
    }

  </script>
</head>

<body>
  <h1>
    Casper is
    <script>document.write(getHeadline())</script>
  </h1>
  <div>
    <h2>or</h2>
    <ul>
      <script>
        document.write(
          Object
            .entries(values)
            .map(([key, value]) => `<li>${Math.floor(value).toLocaleString()} ${Math.floor(value) === 1 ? key.slice(0, -1) : key} old</li>`)
            .join('')
        )
      </script>
    </ul>
  </div>
</body>
